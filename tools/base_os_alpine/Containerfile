This is generated by build/Makefile


PAYLOAD_CONTAINER_FILE = $(BUILD_DIR)/Containerfile
$(PAYLOAD_CONTAINER_FILE) :
        mkdir -p $(BUILD_DIR)/scripts
        mkdir -p $(BUILD_DIR)/templates
        mkdir -p sbom
        cp docker-entrypoint.sh  $(BUILD_DIR)/docker-entrypoint.sh
        cp  scripts/* $(BUILD_DIR)/scripts
        cp  -f -r templates/* $(BUILD_DIR)/templates
        echo "FROM scratch" > $@
        echo 'LABEL org.opencontainers.image.title=$(IMAGE_TITLE)' >> $@
        echo 'LABEL org.opencontainers.image.created=$(IMAGE_CREATED)' >> $@
        echo 'LABEL org.opencontainers.image.revision=$(IMAGE_REVISION)' >> $@
        echo 'LABEL org.opencontainers.image.vendor=$(IMAGE_VENDOR)' >> $@
        echo 'LABEL org.opencontainers.image.version=$(IMAGE_VERSION)' >> $@
        echo 'LABEL org.opencontainers.image.authors=$(IMAGE_AUTHOR)' >> $@
        echo "ADD rootfs.tar.gz /" >> $@
        echo "COPY scripts/bom.sh /usr/local/bin/bom.sh " >> $@
        echo "RUN chmod 755 /usr/local/bin/bom.sh" >> $@
        echo "COPY docker-entrypoint.sh / " >> $@
        echo "RUN chmod 755 /docker-entrypoint.sh" >> $@
        echo "COPY templates/ /opt/base_os/templates/" >> $@
        echo "COPY scripts/ /opt/base_os/scripts/" >> $@
        echo "RUN chmod -R 755 /opt/base_os" >> $@
        echo "ENTRYPOINT [\"/docker-entrypoint.sh\"]" >> $@
        echo 'CMD ["help"]' >> $@



Step 1/17 : FROM scratch
Step 8/17 : ADD rootfs.tar.gz /
Step 9/17 : COPY scripts/bom.sh /usr/local/bin/bom.sh
Step 10/17 : RUN chmod 755 /usr/local/bin/bom.sh
Step 11/17 : COPY docker-entrypoint.sh /
Step 12/17 : RUN chmod 755 /docker-entrypoint.sh
Step 13/17 : COPY templates/ /opt/base_os/templates/
Step 14/17 : COPY scripts/ /opt/base_os/scripts/
Step 15/17 : RUN chmod -R 755 /opt/base_os
Step 16/17 : ENTRYPOINT ["/docker-entrypoint.sh"]
Successfully tagged base_os_alpine:3.15.10



The container to build the image requires a small builder 

BUILD_CONTAINER_FILE = $(BUILDER_DIR)/Containerfile


$(BUILD_CONTAINER_FILE) :
        mkdir -p $(BUILDER_DIR)/scripts
        cp  scripts/* $(BUILDER_DIR)/scripts
        echo "FROM alpine:$(ALPINE_VERSION)" > $@
        echo "COPY scripts/mkimage-alpine.bash scripts/apk-install /" >> $@
        echo "RUN /apk-install bash tzdata xz curl" >> $@
        echo "ENTRYPOINT [\"/mkimage-alpine.bash\"]"  >> $@


